@model PagedList.IPagedList<LRC_NET_Framework.tb_MemberMaster>
@using PagedList.Mvc
@{
    ViewBag.Title = "School List";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<h2>@ViewBag.CollegeName</h2>
<div style="font-size:smaller">
    @using (Html.BeginForm("MembersBySchool", "Home", FormMethod.Post, new { @class = "margin-right: 0" }))
    {
        @Html.Hidden("CollegeID", (int)ViewBag.CollegeID)
        <div class="form-group row list-inline">
            <div class="col-md-2">
                <div class="input-group">
                    <span class="input-group-btn">
                        <button class="btn btn-default" type="submit">
                            <i class="glyphicon glyphicon-search"></i>
                        </button>
                    </span>
                    @Html.TextBox("SearchString", null, new { @class = "form-control", placeholder = "Search" })
                </div>
            </div>
        </div>
        <div class="row ex1">
            <div class="col-md-2 align-text-top">Showing @Model.FirstItemOnPage - @Model.Count()&nbsp;&nbsp;of&nbsp;&nbsp;@ViewData["MemberQty"]</div>
            <div class="col-md-3 align-text-top"></div>
            <div class="col-md-7"></div>
        </div>
        <div class="ex1">
            <table class="table table-bordered table-sm">
                @foreach (var item in Model)
                {
                <tr style="background-color:gainsboro;">
                    <td>
                        <div class="row h6">
                            <div class="col-md-3">
                                <div class="row">
                                    <div class="col-md-5" style="font-weight:bold; padding-bottom:5px; padding-top:5px; text-align:right; background:lavender;">
                                        Faculty&nbsp;Member
                                    </div>
                                    <div class="col-md-7 text-muted" style="font-weight:bold; padding-bottom:5px; padding-top:5px; background:lavender">
                                        @Html.ActionLink(item.LastName + ", " + item.FirstName, "Edit", "Home", new { id = item.MemberID, CollegeID = ViewBag.CollegeID }, new { @class = "text -info" })
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row ex1 h6">
                            <div class="col-md-3">
                                <div class="row" style="padding-bottom:5px">
                                    <div class="col-md-5" style="font-weight:bold; text-align:right">
                                        Home School
                                    </div>
                                    <div class="col-md-7 text-muted">
                                        @Html.DisplayFor(modelItem => item.tb_Department.tb_College.CollegeName)
                                    </div>
                                </div>
                                <div class="row" style="padding-bottom:5px">
                                    <div class="col-md-5" style="font-weight:bold; text-align:right">
                                        Employee ID
                                    </div>
                                    <div class="col-md-7 text-muted">
                                        @Html.DisplayFor(modelItem => item.MemberIDNumber)
                                    </div>
                                </div>
                                <div class="row" style="padding-bottom:5px">
                                    <div class="col-md-5" style="font-weight:bold; text-align:right">
                                        JobClass
                                    </div>
                                    <div class="col-md-7 text-danger">
                                    </div>
                                </div>
                                <div class="row" style="padding-bottom:5px">
                                    <div class="col-md-5" style="font-weight:bold; text-align:right">
                                        Department
                                    </div>
                                    <div class="col-md-7 text-muted">
                                        @Html.DisplayFor(modelItem => item.tb_Department.DepartmentName)
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="row" style="padding-bottom:5px">
                                    <div class="col-md-5" style="font-weight:bold; text-align:right">
                                        Category
                                    </div>
                                    <div class="col-md-7 text-muted">
                                        @Html.DisplayFor(modelItem => item.tb_Categories.CategoryName)
                                    </div>
                                </div>
                                <div class="row" style="padding-bottom:5px">
                                    <div class="col-md-5" style="font-weight:bold; text-align:right">
                                        Hire Date (Aprox)
                                    </div>
                                    <div class="col-md-7 text-muted">
                                        @if (item.HireDate != null)
                    {
                        @Convert.ToDateTime(item.HireDate).ToString("MM/dd/yyyy")
}
                                    </div>
                                </div>
                                <div class="row" style="padding-bottom:5px">
                                    <div class="col-md-5" style="font-weight:bold; text-align:right">
                                        Active
                                    </div>
                                    <div class="col-md-7 text-muted">
                                        @if (item.tb_SemesterTaught.Where(t => t.MemberID == item.MemberID).Count() > 0)
                    {
                        <span>Active</span>
}
else
{
                    <span>Inactive</span>
}
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="row" style="padding-bottom:5px">
                                    <div class="col-md-7" style="font-weight:bold; text-align:right">
                                        Member Status
                                    </div>
                                    <div class="col-md-5 text-muted">
                                        @Html.DisplayFor(modelItem => item.tb_MemberActivity.Where(t => t.MemberID == item.MemberID).LastOrDefault().tb_ActivityStatus.ActivityStatusName)
                                    </div>
                                </div>
                                <div class="row" style="padding-bottom:5px">
                                    <div class="col-md-7" style="font-weight:bold; text-align:right">
                                        Fee Payer Assess
                                    </div>
                                    <div class="col-md-5 text-muted">
                                        @if (item.LatestUnionAssessmentID != null)
                    {
                        @Html.DisplayFor(modelItem => item.tb_LatestUnionAssessment.LatestUnionAssessmentDesc)
}
else
{
                    <span>0</span>
}
                                    </div>
                                </div>
                                <div class="row" style="padding-bottom:5px">
                                    <div class="col-md-7" style="font-weight:bold; text-align:right">
                                        Membership&nbsp;Commitment
                                    </div>
                                    <div class="col-md-5 text-muted">
                                        @Html.DisplayFor(modelItem => item.tb_MemberActivity.Where(t => t.MemberID == item.MemberID).LastOrDefault().MembershipCommitment)
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="row" style="padding-bottom:5px">
                                    <div class="col-md-5" style="font-weight:bold; text-align:right;">
                                        Phone
                                    </div>
                                    <div class="col-md-7 text-muted" style="font-weight:bold;">
                                        @if (item.tb_MemberPhoneNumbers.Count > 0)
                                        {
                                            @Html.ActionLink(item.tb_MemberPhoneNumbers.FirstOrDefault().PhoneNumber, "ManageContactInfo", "Home", new { id = item.MemberID, CollegeID = ViewBag.CollegeID }, new { @class = "text -info" })
                                        }
                                        else
                                        {
                                            @Html.ActionLink("Add Pnone", "ManageContactInfo", "Home", new { id = item.MemberID, CollegeID = ViewBag.CollegeID }, new { @class = "text -info" })
                                        }
                                    </div>
                                </div>
                                <div class="row" style="padding-bottom:5px">
                                    <div class="col-md-5" style="font-weight:bold; text-align:right">
                                        Address
                                    </div>
                                    <div class="col-md-7 text-muted">
                                        @Html.DisplayFor(modelItem => item.tb_MemberAddress.Where(t => t.MemberID == item.MemberID).FirstOrDefault().HomeStreet1)
                                        @Html.DisplayFor(modelItem => item.tb_MemberAddress.Where(t => t.MemberID == item.MemberID).FirstOrDefault().HomeStreet2)
                                        @Html.DisplayFor(modelItem => item.tb_MemberAddress.Where(t => t.MemberID == item.MemberID).FirstOrDefault().tb_CityState.CityName)
                                        @Html.DisplayFor(modelItem => item.tb_MemberAddress.Where(t => t.MemberID == item.MemberID).FirstOrDefault().tb_CityState.CityAlias)
                                        @Html.DisplayFor(modelItem => item.tb_MemberAddress.Where(t => t.MemberID == item.MemberID).FirstOrDefault().ZipCode)
                                    </div>
                                </div>
                            </div>
                        </div>
                    </td>
                </tr>
                    <tr>
                        <td colspan="7">
                            <table class="table table-sm">
                                <tr>
                                    <th style="background-color:gainsboro;">
                                        <i>School</i>
                                    </th>
                                    <th style="background-color:gainsboro;"></th>
                                    <th style="background-color:gainsboro;">
                                        <i>Campus</i>
                                    </th>
                                    <th style="background-color:gainsboro;">
                                        <i>Building</i>
                                    </th>
                                    <th style="background-color:gainsboro;">
                                        <i>Room</i>
                                    </th>
                                    <th style="background-color:gainsboro;">
                                        <i>Reason</i>
                                    </th>
                                    <th style="background-color:gainsboro;">
                                        <i>Class</i>
                                    </th>
                                    <th style="background-color:gainsboro;">
                                        <i>Days</i>
                                    </th>
                                    <th style="background-color:gainsboro;">
                                        <i>Start</i>
                                    </th>
                                    <th style="background-color:gainsboro;">
                                        <i>End</i>
                                    </th>
                                    <th style="background-color:gainsboro;">
                                        <i>Note</i>
                                    </th>
                                    <th style="background-color:gainsboro;">Schedule Status</th>
                                </tr>
                                @foreach (var record in item.tb_SemesterTaught)
                                {
                                <tr>
                                    <td>
                                        @Html.DisplayFor(modelItem => record.tb_Building.tb_Campus.tb_College.CollegeName)
                                    </td>
                                    <td>
                                        <a href="#" class="btn btn-xs"><span class="glyphicon glyphicon-list-alt" aria-hidden="true"></span></a>
                                    </td>
                                    <td>
                                        @Html.DisplayFor(modelItem => record.tb_Building.tb_Campus.CampusName)
                                    </td>
                                    <td>
                                        @Html.DisplayFor(modelItem => record.tb_Building.BuildingName)
                                    </td>
                                    <td>
                                        @Html.DisplayFor(modelItem => record.Room)
                                    </td>
                                    <td>???</td>
                                    <td>
                                        @Html.DisplayFor(modelItem => record.Class)
                                    </td>
                                    <td>
                                        @Html.DisplayFor(modelItem => record.tb_WeekDay.WeekDayName)
                                    </td>
                                    <td>
                                        @Html.DisplayFor(modelItem => record.ClassStart)
                                    </td>
                                    <td>
                                        @Html.DisplayFor(modelItem => record.ClassEnd)
                                    </td>

                                    <td>???</td>
                                    <td>
                                        @if (record != null)
                                        {
                                            <span>Active</span>
                                        }
                                        else
                                        {
                                            <span>Inactive</span>
                                        }                                    
                                    </td>
                                </tr>
                                }
                            </table>
                        </td>
                    </tr>
                }
            </table>
            <br />
            Page @(Model.PageCount < Model.PageNumber ? 0 : Model.PageNumber) from @Model.PageCount

            @Html.PagedListPager(Model, page => Url.Action("MembersBySchool", new { page, CollegeID = ViewBag.CollegeID, searchString = ViewBag.Search }))
        </div>
    }
</div>

